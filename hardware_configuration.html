<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Proto2Dev: Hardware configuration of Bedsensor prototype</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pawmint_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Proto2Dev
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Hardware configuration of Bedsensor prototype </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page describes and explains all important things to know about hardware configuration and linkage of bedsensor's components.</p>
<h1><a class="anchor" id="Multiplexageboard"></a>
Multiplexage board</h1>
<p>The board supplied by I2R is a printed circuit board for the multiplexage of eight analog channels and the convertion of signals from analogic to digital. The following picture shows the board and its important parts. The main components of the board is the ADS7828. The communication with the board is in fact the communication with the ADS7828 ship. A driver has been developp in order to work with it : <a class="el" href="_a_d_s7828_8h.html">ADS7828.h</a>. </p>
<div class="image">
<img src="jit.jpg" alt="jit.jpg"/>
</div>
<h2><a class="anchor" id="Alimentation"></a>
Alimentation</h2>
<p>The board can be supply by three way :</p>
<ul>
<li>Using the connector jack power with a external power source of 3V.</li>
<li>Using connectors on the side of the board tagged +3.3V and GND as shown in <a class="el" href="hardware_configuration.html#Connectiontothearduino">Connection to the Arduino Uno</a> subsection.</li>
<li>Using straight connectors tagged +3.3V and GND showed in the following picture.</li>
</ul>
<div class="image">
<img src="jitplug.JPG" alt="jitplug.JPG"/>
</div>
<h2><a class="anchor" id="Connectiontothearduino"></a>
Connection to the Arduino Uno</h2>
<p>Arduino and the board communicate throught an I2C bus (abouti2c). Two wires named SDA (Serial Data Line) and SCL (Serial Clock Line) should be placed in order to ensure the communication. The following picture shows the I2C connection and power sharing between the Arduino Uno and the I2R board. </p>
<dl class="section note"><dt>Note</dt><dd>GND Wire can be plug in one of the two GND pin of the Arduino Uno. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The sequence between SDA and SCL are different on the I2R board and on the Arduino Uno.</dd></dl>
<div class="image">
<img src="jitLink.JPG" alt="jitLink.JPG"/>
</div>
<h2><a class="anchor" id="I2Caddressconfiguration"></a>
I2C address configuration</h2>
<p>As explain in the page abouti2c , like other I2C devices, ADS7828 has a configurable I2C address on two bits. They can be set with I2C addr jumpers named <code>J10</code> and <code>J11</code> on the I2R board. As yon can see on the following picture, I2C address bit can be set to value <code>0</code> by placing jumpers on middle and right connectors and can be set to <code>1</code> by placing jumpers on left and middle connectors. The jumper <code>J10</code> set the bit generally named <code>A0</code> who is the most significant bit (MSB) of the I2C address and the jumper <code>J11</code> set the bit generally named <code>A1</code> whois the less significant bit (LSB) of the I2C address. On the picture <code>J10</code> and <code>J11</code> are coding <code>0</code> so the I2C address will be <code>0b00</code> . </p>
<div class="image">
<img src="jiti2caddr.JPG" alt="jiti2caddr.JPG"/>
</div>
<h2><a class="anchor" id="Voltagedividerconfiguration"></a>
Voltage divider configuration</h2>
<p>Each analog channel of the I2R board use a voltage divider in order to manage the sensibility of the pluged sensor. </p>
<div class="image">
<img src="volatgedivider.JPG" alt="volatgedivider.JPG"/>
</div>
<p>The previous image extract from the datasheet of the FSRs sensors shows the scheme of a voltage divider and a plot of the outpt voltage depending on the second resistor's value (RM). The voltage follower (the AOP with feedback (the kind of triangle with a wire who come back)) ensures that there is no influence of the circuit part at the right of him, on the left part. This component is already on the ADS7828 so there isn't replaced on the board.</p>
<div class="image">
<img src="jitvolt.JPG" alt="jitvolt.JPG"/>
</div>
<p>The RM value can be set thank to variable resistor placed on the board. The resistor can be changed with a Phillips screwdriver between a min position (0 ohm) and a max position (100 kohm). I advice to set the RM value to 17 kohm for our application. To performed an accurate set, you should use an ohmmeter with the input lane on the corresponding test point and the COM lane on Vout sensor pin such as on the next picture.</p>
<div class="image">
<img src="jitMulti.JPG" alt="jitMulti.JPG"/>
</div>
<p>For more information about de multiplexage board, refers to :</p>
<ul>
<li><a href="ads7828.pdf">the ADS7828's datasheet</a>;</li>
<li><a href="3103_0_interlink-fsr-user-guide.pdf">the FSR's datasheet</a>;</li>
<li><a href="fsr_sensor_board_20120523.pdf">the wiring plan of the board</a>.</li>
</ul>
<h1><a class="anchor" id="ArduinoBoard"></a>
Arduino Board</h1>
<div class="image">
<img src="arduino.JPG" alt="arduino.JPG"/>
</div>
<h2><a class="anchor" id="Powersupply"></a>
Power supply</h2>
<p>The Arduino Uno can be powered by three different way :</p>
<ul>
<li>The USB interface;</li>
<li>The power supply jack with a recommended input voltage between <code>7V</code> and <code>12V</code> and limits input voltage between <code>6V</code> and <code>20V</code> ;</li>
<li>Using the power pin of the board : The positive power supply wire should be link to the <code>VIN</code> pin and the ground wire should be link to one of the three <code>GND</code> pin.</li>
</ul>
<h2><a class="anchor" id="Directlinktosensors"></a>
Direct link to sensors</h2>
<p>You can directly plug a sensor thank to the analog input of the Arduino Uno named from <code>A0</code> to <code>A5</code>. The folowing scheme shows the connetion of the voltage divider to the Arduino board with the pin <code>A0</code>. Don't forget that pin <code>A4</code> and pin <code>A5</code> are reserved for I2C bus. </p>
<div class="image">
<img src="Arduino1FSR.png" alt="Arduino1FSR.png"/>
</div>
<h1><a class="anchor" id="ShieldXbee"></a>
Shield Xbee</h1>
<h2><a class="anchor" id="Plugashield"></a>
Plug a shield</h2>
<p>Pretty simple, just considers the orientation. </p>
<div class="image">
<img src="aruinoShield2.JPG" alt="aruinoShield2.JPG"/>
</div>
<h2><a class="anchor" id="PluganXbeemodule"></a>
Plug an Xbee module</h2>
<p>Same as previous... </p>
<div class="image">
<img src="shieldxbee1.JPG" alt="shieldxbee1.JPG"/>
</div>
<h2><a class="anchor" id="SelectUSARTsource"></a>
Select USART source</h2>
<p>The Xbee module and the Arduino Uno communicate throught the USART bus materialized by the RX and TX lanes. The same bus is used by the Arduino Uno to communicate by the USB interface. To avoid interferences between this two components the Xbee shield has a switch to select the correct input depending on the application. The <code>MICRO</code> position allows the communication with the Xbee and the <code>USB</code> position allows the communication with the USB interface. </p>
<dl class="section note"><dt>Note</dt><dd>Don't forget to use this switch when you would flash the Arduino's microcontroller through USB.</dd></dl>
<div class="image">
<img src="shieldswitch.JPG" alt="shieldswitch.JPG"/>
</div>
<h1><a class="anchor" id="XbibUdev"></a>
Xbib U-dev</h1>
<p>The Xbib U-dev is an USB interface for Xbee module. It is used for interfacing an Xbee module with a UbiGate platform like BeagleBone Black or Raspberry Pi. This board was designed for the prototyping with Xbee and has lot of features of which we do not serve us. It shouldn't be used as a final product and should be replaced by a simplest device like <a href="http://www.lextronic.fr/P2901-platine-dinterface-usb-pour-modules-xbee.html">this one</a>.</p>
<div class="image">
<img src="xbibDr.JPG" alt="xbibDr.JPG"/>
</div>
<h2><a class="anchor" id="PluganXbeemodule"></a>
Plug an Xbee module</h2>
<p>Same as Xbee module on Xbee Shield </p>
<div class="image">
<img src="xbibxbee1.JPG" alt="xbibxbee1.JPG"/>
</div>
<h2><a class="anchor" id="Theloopbackjumper"></a>
The loop-back jumper</h2>
<p>The Xbib U-dev is trasparent for the Xbee and the PC. Send data to the Xbib U-dev is equivalent to send data to the Xbee. The only thing who affect the communication is the loopback option. When you communicate with the Xbee "by hand", it could be nice to see what you send and a loop-back jumper is available to handle this issue. In production mode the loop-back should be disable as shown in the next picture.</p>
<div class="image">
<img src="xbibloopback2.JPG" alt="xbibloopback2.JPG"/>
</div>
<h2><a class="anchor" id="ConnexionfromPCtoXbee"></a>
Connexion from PC to Xbee</h2>
<ol type="1">
<li><p class="startli"><b>Windows :</b> There are several applications to perform serial connection. You can use the well known PuTTY available on is <a href="http://www.putty.org/">official website</a>. To start a communication with the Xbee :</p>
<ul>
<li>Open the device manager from the control panel;</li>
<li>In <code>Ports (COM and LPT)</code> subtree, find the right lane;</li>
<li>Launch putty;</li>
<li>Select the <code>Session</code> category;</li>
<li>In <code>Connection type</code>, select <code>Serial</code>;</li>
<li>In <code>Serial line</code> text box, copy the name of the lane. In the example <code>COM7</code> ;</li>
<li>Launch the communication by clicking on <code>Open</code> button.</li>
</ul>
<div class="image">
<img src="putty.JPG" alt="putty.JPG"/>
</div>
</li>
<li><b>Linux :</b> Like windows, you have many ways to perform a serial commnication.<ul>
<li>First you need to find the descriptor of the device : It can be found in the <code>/dev/serial</code> directory The exact path should be <code>/dev/serial/by-id/usb-FTDI_XBIB-U-DEV-if00-port0</code> ;</li>
<li>Then launch a suitable application like <code>minicom</code> or <code>screen</code> : <div class="fragment"><div class="line">minicom -b 9600 -D /dev/serial/by-<span class="keywordtype">id</span>/usb-FTDI_XBIB-U-DEV-if00-port0</div>
</div><!-- fragment --> <div class="fragment"><div class="line">screen /dev/serial/by-<span class="keywordtype">id</span>/usb-FTDI_XBIB-U-DEV-if00-port0 9600</div>
</div><!-- fragment --></li>
</ul>
</li>
<li><b>Mac :</b> There's an app for that</li>
</ol>
<p>Then all that you typing on your keyboard is sent to the Serial bus and Xbee's answers are displayed in the application. If you would see what you are typing, think about the loop-back jumper. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 4 2014 10:05:37 for Proto2Dev by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
